/* ================================ */
/* === STYLING DASAR & TEMA === */
/* ================================ */

/* Variabel CSS untuk tema (Dark Mode Default) */
:root {
    --bg: #0b1324;               /* Warna background utama */
    --panel: #111a33;            /* Warna panel/kartu */
    --ink: #e8eefc;              /* Warna teks utama */
    --muted: #9fb2d7;           /* Warna teks sekunder/redup */
    --accent: #46b07b;           /* Warna aksen utama (misal: toggle aktif) */
    --accent-rgb: 70, 176, 123;  /* Versi RGB dari aksen utama (untuk box-shadow) */
    --accent-2: #5aa4ff;         /* Warna aksen sekunder (misal: tombol primer, focus) */
    --accent-2-rgb: 90, 164, 255;/* Versi RGB dari aksen sekunder */
    --warn: #ffb057;             /* Warna background peringatan/error */
    --warn-text: #000;           /* Warna teks peringatan/error */
    --grid: #1c2849;             /* Warna border/garis pemisah */
    --on: #1f7a55;               /* Warna sel K-Map 'ON' (gradien bawah) */
    --on-2: #2b966a;             /* Warna sel K-Map 'ON' (gradien atas) */
    --off: #243255;              /* Warna sel K-Map 'OFF' */
    --dontcare: #6b4220;         /* Warna sel K-Map 'Don't Care' */
    --dontcare-border: #9c5b25;  /* Warna border sel K-Map 'Don't Care' */
    --badge: #263665;            /* Warna background tombol sekunder/badge */
    --code: #0f1a35;             /* Warna background input/kode */
}

/* Variabel CSS untuk TEMA TERANG (LIGHT MODE) */
body.light-mode {
    --bg: #f4f7fa;
    --panel: #ffffff;
    --ink: #1a253c;
    --muted: #5a6b87;
    --accent: #28a745;
    --accent-rgb: 40, 167, 69;
    --accent-2: #007bff;
    --accent-2-rgb: 0, 123, 255;
    --warn: #ffc107;
    --warn-text: #333;

    /* PERBAIKAN: Garis pemisah dibuat lebih gelap agar tegas */
    --grid: #adb5bd;

    --on: #28a745;
    --on-2: #2dbc4e;
    --off: #e9ecef;
    --dontcare: #fff3cd;

    /* PERBAIKAN: Border 'dont-care' dibuat lebih gelap */
    --dontcare-border: #ffc107;

    --badge: #e2e8f0;
    --code: #f0f4f9;
    background: var(--bg);
}

/* Reset dasar & box-sizing */
* {
    box-sizing: border-box;
}

/* Styling dasar body - TANPA ANIMASI */
body {
    margin: 0;
    font: 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color: var(--ink);
    background: var(--bg);
    transition: background .3s ease, color .3s ease; /* Transisi untuk ganti tema */
    /* Properti animasi strobe telah dihapus */
}

/* Styling Header */
header {
    grid-area: header;
    padding: 16px 24px;
    border-bottom: 1px solid var(--grid);
    background-color: var(--panel);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

header h1 {
    margin: 0;
    font-size: 18px;
    letter-spacing: .3px;
}

/* ================================ */
/* === LAYOUT DASHBOARD (CSS GRID) === */
/* ================================ */
.dashboard-layout {
    display: grid;
    grid-template-columns: 320px 1fr;
    grid-template-rows: auto auto;
    grid-template-areas:
        "header header"
        "sidebar main";
    min-height: 100vh;
}

/* Styling Sidebar */
.sidebar {
    grid-area: sidebar;
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 16px;
    border-right: 1px solid var(--grid);
}

/* Styling Area Konten Utama */
.main-content {
    grid-area: main;
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 16px;
}

/* Grid untuk panel statistik */
.stats-grid {
    display: grid;
    /* KEMBALIKAN ke 3 kolom sama lebar */
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
}

/* Grid untuk hasil (Tabel & K-Map) */
.results-grid {
    display: grid;
    grid-template-columns: 1.1fr 1fr;
    gap: 16px;
    align-items: start;
}

/* ================================ */
/* === GAYA KOMPONEN & EFEK === */
/* ================================ */

/* Styling umum untuk Kartu/Panel - TANPA ANIMASI */
.card {
    background: var(--panel);
    border: 1px solid var(--grid);
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, .05);
    transition: all 0.2s ease-out;
    /* Properti animasi strobe telah dihapus */
}

/* Efek hover pada kartu */
.card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, .1);
    border-color: var(--accent-2);
}
body.light-mode .card:hover {
    box-shadow: 0 10px 20px rgba(0, 0, 0, .07);
}

/* Judul di dalam kartu */
.card h2 {
    margin: 0 0 12px;
    font-size: 16px;
    border-bottom: 1px solid var(--grid);
    padding-bottom: 8px;
}

/* Styling khusus untuk kartu statistik */
.card-stat {
    padding: 14px 18px;
}
.card-stat label {
    font-size: 13px;
    color: var(--muted);
}
.card-stat .stat-value {
    font-size: 18px;
    font-weight: 600;
    display: block;
    margin-top: 4px;
    background: none;
    padding: 0;
    border-radius: 0;
    color: var(--ink);
}

/* GAYA BARU UNTUK WAKTU BENCHMARK DI DALAM KARTU STAT */
.card-stat .stat-benchmark {
    display: block;
    font-size: 13px;
    color: var(--muted);
    font-weight: 500;
    margin-top: 2px; /* Jarak kecil dari hasil SOP */
}


/* Styling untuk grup field (label + input/select) */
.field {
    display: grid;
    gap: 8px;
    margin: 10px 0 14px;
}

/* Perbaikan untuk margin-top field pertama setelah dropdown dihapus */
.card h2 + .field {
    margin-top: 10px;
}


/* Styling Label */
label {
    color: var(--muted);
    font-size: 12px;
    font-weight: 500;
}

/* Styling Input teks, textarea, dan select */
input[type=text],
textarea,
select {
    width: 100%;
    padding: 10px 12px;
    background: var(--code);
    color: var(--ink);
    border: 1px solid var(--grid);
    border-radius: 10px;
    outline: none;
    transition: border-color .2s ease, box-shadow .2s ease;
}

/* Efek focus */
input[type=text]:focus,
textarea:focus,
select:focus {
    border-color: var(--accent-2);
    box-shadow: 0 0 0 3px rgba(var(--accent-2-rgb), 0.25);
}

/* Styling grup tombol */
.actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

/* BARU: Aturan khusus untuk tombol Contoh Uji (F1-F10) */
.sidebar .field:has(#btn-ex1) .actions {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 6px;
}


/* Styling Tombol Umum */
button {
    background: linear-gradient(180deg, #1f3d7a, #1a3366);
    border: 1px solid #2a4aa5;
    color: white;
    border-radius: 10px;
    padding: 10px 14px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease-out;
    will-change: transform, background, box-shadow;
}

/* Efek Hover Tombol */
button:not(:disabled):hover {
    transform: translateY(-2px);
    filter: brightness(1.1);
    box-shadow: 0 4px 15px -2px rgba(var(--accent-2-rgb), 0.3);
}

/* Override tombol untuk light mode */
body.light-mode button {
    background: var(--accent-2);
    border-color: #0069d9;
    /* PERBAIKAN: Paksa teks tombol utama jadi putih agar terbaca */
    color: white;
}
body.light-mode button:not(:disabled):hover {
    box-shadow: 0 4px 15px -2px rgba(var(--accent-2-rgb), 0.4);
}

/* Styling Tombol Sekunder */
button.secondary {
    background: var(--badge);
    border-color: var(--grid);
    color: var(--ink); /* Teks tombol sekunder mengikuti tema */
}
button.secondary:not(:disabled):hover {
    box-shadow: 0 4px 15px -2px rgba(150, 160, 180, 0.1);
}

/* Styling Tombol Mini (F1-F10) */
button.mini-btn {
    padding: 4px 10px;
    font-size: 12px;
}

/* Styling Tombol Disabled */
button:disabled {
    opacity: 0.6;
    cursor: default;
}

/* Styling Tabel */
table {
    width: 100%;
    border-collapse: collapse;
}
th, td {
    text-align: center;
    padding: 8px;
    border-bottom: 1px solid var(--grid);
}

/* Wrapper Tabel Kebenaran */
.tt {
    overflow-x: auto;
    border: 1px solid var(--grid);
    border-radius: 10px;
}

/* ================================ */
/* === K-MAP BARU (GRID & LABELS) === */
/* ================================ */
/* Container utama K-Map */
.kmap-container {
    display: grid;
    grid-template-areas:
        "corner top"
        "left   map";
    grid-template-columns: auto 1fr;
    grid-template-rows: auto 1fr;
    gap: 6px;
    margin-top: 6px;
}

/* Pojok kiri atas K-Map */
.kmap-corner {
    grid-area: corner;
    display: grid;
    place-items: center;
    font-size: 12px;
    font-weight: 600;
    color: var(--muted);
    padding: 4px 8px;
    min-width: 40px;
}

/* Area untuk label atas (kolom) */
.kmap-label-top {
    grid-area: top;
    display: grid;
    gap: 6px;
}

/* Area untuk label kiri (baris) */
.kmap-label-left {
    grid-area: left;
    display: grid;
    gap: 6px;
}

/* Styling untuk label Gray code */
.kmap-axis-label {
    display: grid;
    place-items: center;
    font-size: 12px;
    font-weight: 600;
    color: var(--muted);
    background: var(--code);
    border-radius: 6px;
    border: 1px solid var(--grid);
    padding: 4px;
}

/* Wrapper untuk sel K-Map */
.kmap-wrapper {
    grid-area: map;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    border: 1px solid var(--grid);
    border-radius: 10px;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.00));
}

/* Grid internal untuk sel K-Map */
.kmap {
    display: grid;
    gap: 6px;
    align-content: start;
    padding: 8px;
    position: relative;
    grid-auto-flow: row;
    min-width: fit-content;
}

/* Styling Sel K-Map */
.kcell {
    width: 56px;
    height: 44px;
    display: grid;
    place-items: center;
    border-radius: 10px;
    border: 1px solid var(--grid);
    background: var(--off);
    color: var(--ink);
    cursor: pointer;
    user-select: none;
    position: relative;
    transition: transform .1s ease, background .2s ease, border-color .2s ease;

    /* MODIFIKASI: Perbesar nilai utama & beri ruang bawah */
    font-size: 18px;
    font-weight: 600;
    padding-bottom: 10px;
}
.kcell.on {
    background: linear-gradient(180deg, var(--on-2), var(--on));
    border-color: #2fb07c;
    color: white;
}
.kcell.dont-care {
    background: var(--dontcare);
    border-color: var(--dontcare-border);
    color: var(--muted);
    font-style: italic;
}
.kcell:hover {
    transform: translateY(-1px) scale(1.02);
    border-color: var(--accent);
}

/* BARU: Tambahkan nomor minterm di bagian bawah sel (HANYA LAYAR) */
.kcell::after {
    content: attr(data-index); /* Ambil nomor dari atribut 'data-index' */
    position: absolute;
    bottom: 4px; /* Posisikan di bawah */
    left: 50%; /* Posisikan di tengah horizontal */
    transform: translateX(-50%); /* Sempurnakan posisi tengah */

    color: var(--muted); /* Warna redup */
    font-size: 11px; /* Ukuran font kecil */
    font-weight: 400; /* Kembali ke font normal */
    opacity: 0.7; /* Sedikit transparan agar tidak mengganggu */
}


/* Styling blok kode */
code, .code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    background: var(--code);
    border: 1px solid var(--grid);
    color: var(--ink);
    padding: 8px 10px;
    border-radius: 10px;
    display: block;
    line-height: 1.4;
    min-height: 38px;
}

/* Styling kode inline */
.code-inline {
    display: inline-block;
    padding: 2px 6px;
    min-height: 0;
    border-radius: 6px;
    font-size: 13px;
    line-height: 1.2;
    font-weight: 500;
}

/* Teks kecil/redup */
.mini {
    font-size: 12px;
    color: var(--muted);
}

/* Garis pemisah horizontal */
.sep {
    height: 1px;
    background: var(--grid);
    margin: 16px 0;
}

/* Styling kotak pesan error */
.error-msg {
    background: var(--warn);
    color: var(--warn-text);
    padding: 10px 12px;
    border-radius: 8px;
    margin-top: 12px;
    font-weight: 500;
    border: 1px solid var(--dontcare-border);
}

/* Toggle Tema */
.theme-toggle { display: flex; align-items: center; gap: 8px; font-size: 12px; }
.toggle-switch { position: relative; display: inline-block; width: 40px; height: 22px; }
.toggle-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--badge); transition: .4s; border-radius: 22px; }
.slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked+.slider { background-color: var(--accent); }
input:checked+.slider:before { transform: translateX(18px); }

/* ================================ */
/* === RESPONSIVE === */
/* ================================ */
@media (max-width: 980px) {
    /* Layout menjadi 1 kolom di layar kecil */
    .dashboard-layout {
        grid-template-columns: 1fr;
        grid-template-areas:
            "header"
            "sidebar"
            "main";
        height: auto;
        min-height: 100vh;
    }
    .sidebar {
        border-right: none;
    }
    /* Panel statistik jadi 1 kolom */
    .stats-grid {
         grid-template-columns: 1fr;
    }
    /* Hasil (Tabel & K-Map) jadi 1 kolom */
    .results-grid {
        grid-template-columns: 1fr;
        align-items: start;
    }
}

/* ================================ */
/* === STYLING KHUSUS CETAK === */
/* ================================ */
@media print {
    /* Sembunyikan elemen spesifik: header, sidebar, stats, tabel kebenaran */
    body > header,
    body > .dashboard-layout > aside.sidebar,
    body > .dashboard-layout > .main-content > .stats-grid,
    body > .dashboard-layout > .main-content > .results-grid > .card:not(#kmap-print-card) { /* Sembunyikan kartu lain (Tabel Kebenaran) */
        display: none !important;
    }

    /* Reset layout utama agar kartu K-Map bisa tampil penuh */
    body,
    body > .dashboard-layout,
    body > .dashboard-layout > .main-content,
    body > .dashboard-layout > .main-content > .results-grid {
        display: block !important; /* Hapus grid/flex */
        padding: 0 !important;
        margin: 0 !important;
        border: none !important;
        box-shadow: none !important;
        background: #ffffff !important; /* Paksa background putih */
        color: #000000 !important; /* Paksa teks hitam */
        /* Hentikan animasi saat cetak */
        animation: none !important;
    }

    /* Atur tampilan kartu K-Map untuk dicetak */
    #kmap-print-card {
        display: block !important; /* Pastikan terlihat */
        visibility: visible !important;
        width: 100% !important; /* Lebar penuh */
        box-shadow: none !important;
        border: 1px solid #999 !important; /* Garis batas sederhana */
        page-break-inside: avoid; /* Hindari terpotong antar halaman */
        margin: 0 !important;
        padding: 16px !important;
        background: #ffffff !important; /* Background putih */
        /* Hentikan animasi kartu saat cetak */
        animation: none !important;
    }

    /* Pastikan semua elemen di dalam kartu K-Map terlihat */
     #kmap-print-card * {
        visibility: visible !important;
        color: #000000 !important; /* Teks hitam */
    }
    .muted {
        color: #555 !important; /* Kecuali teks muted */
    }

    /* Atur ulang gaya internal K-Map agar ramah cetak */
    .kmap-container, .kmap {
        display: grid !important;
    }
    .kmap-axis-label, .kcell {
        border: 1px solid #999 !important; /* Garis abu-abu */
        display: grid !important;
        place-items: center !important;
        background: #fff !important; /* Background putih */
        color: #000 !important; /* Teks hitam */
        /* Pastikan padding bawah tidak ada saat cetak */
        padding-bottom: 0 !important;
        height: 44px !important; /* Kembalikan tinggi */
        font-size: 14px !important; /* Reset font size */
        font-weight: normal !important; /* Reset font weight */
    }
    .kcell.on {
        background: #ccc !important; /* Abu-abu untuk '1' */
        color: #000 !important;
        font-weight: bold !important; /* Tebalkan angka 1 */
    }
     .kcell.dont-care {
        background: #eee !important; /* Abu-abu lebih terang untuk 'd' */
        color: #555 !important;
        font-style: italic;
     }
     /* Nomor minterm pada ::after tetap terlihat */
     .kcell::after {
         color: #555 !important;
         opacity: 1 !important;
         font-size: 10px !important; /* Kecilkan sedikit */
         bottom: 2px !important; /* Naikkan sedikit */
    }

    /* Sembunyikan tombol dan input di bawah K-Map saat mencetak */
    #kmap-print-card .actions,
    #kmap-print-card .field:has(#minterm-io),
    #kmap-print-card .field:has(#out-simplified) label { /* Sembunyikan label juga */
        display: none !important;
    }
    /* Tampilkan hasil SOP/POS saja */
     #kmap-print-card #out-simplified {
         display: block !important;
         border: none !important;
         padding: 0 !important;
         margin-top: 10px !important;
         background: none !important;
         color: #000 !important;
         font-size: 14px;
     }
}

/* Keyframes untuk strobe DIHAPUS */
/* @keyframes strobeEffect { ... } */